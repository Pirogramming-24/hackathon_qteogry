{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q&A Service</title>
    
    <link rel="stylesheet" href="{% static 'questions/css/main_ny.css' %}">
    <link rel="stylesheet" href="{% static 'questions/understanding_check_upload.css' %}">
    <link rel="stylesheet" href="{% static 'questions/understanding_check.css' %}">
    <script src="{% static 'questions/understanding_check.js' %}" defer></script>
</head>
<body>

    {% comment %} understanding {% endcomment %}


    <div class="header-container_ny">
        <div class="header-top_ny">
            
            <!-- â¬…ï¸ ì™¼ìª½: ì œëª© + íƒ­ -->
            <div class="header-left_ny">
                <h1 class="page-title_ny">[1ì¼ì°¨] Django ì‹¤ìŠµ</h1>

                <nav class="tab-menu_ny">
                    <a href="?sort=all" class="tab-item_ny {% if sort_mode == 'all' %}active_ny{% endif %}">ëª¨ë“  ì§ˆë¬¸</a>
                    <a href="?sort=concept" class="tab-item_ny {% if sort_mode == 'concept' %}active_ny{% endif %}">ê°œë… ì§ˆë¬¸ë§Œ</a>
                    <a href="?sort=likes" class="tab-item_ny {% if sort_mode == 'likes' %}active_ny{% endif %}">ê³µê° ìˆœìœ¼ë¡œ</a>
                    <a href="?sort=my" class="tab-item_ny {% if sort_mode == 'my' %}active_ny{% endif %}">ë‚´ ì§ˆë¬¸</a>
                </nav>
            </div>

            <!-- â¡ï¸ ì˜¤ë¥¸ìª½: Understanding Check -->
            <div class="header-right_ny">
                <div class="understanding-check-bar-hs">
                    <div class="check-action-hs">
                        <a href="{% url 'questions:understanding_check_upload' %}" class="check-upload-btn-hs">
                            ìƒˆë¡œìš´ ì´í•´ë„ check ì˜¬ë¦¬ê¸°
                        </a>
                    </div>

                    <div class="check-content-hs">
                        ğŸ§  {{ understanding_check.content }}
                    </div>

                    <div class="check-progress-hs">
                        <span>{{ response_count }} / {{ total_count }}</span>

                        <div class="progress-bar-bg">
                            <div
                                class="progress-bar-fill"
                                style="width: {{ progress }}%;"
                            ></div>
                        </div>
                    </div>

                    <button
                        type="button"
                        class="check-yes-btn"
                        data-id="{{ understanding_check.id }}"
                        data-url="{% url 'questions:understanding_check_respond' %}"
                        data-csrf="{{ csrf_token }}"
                    >
                        ë„¤
                    </button>
                </div>
            </div>

        </div>
    </div>


    <main class="main-container_ny">
        
        <section class="question-list_ny">
            {% for question in questions %}
            <div class="question-card_ny">
                <div class="card-header_ny">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <div style="width: 30px; height: 30px; background: #ddd; border-radius: 50%;"></div>
                        <span style="font-weight: bold;">{{ question.user.username }}</span>
                    </div>
                    <span class="badge_ny 
                        {% if question.category == 'CONCEPT' %}badge-concept_ny
                        {% elif question.category == 'ERROR' %}badge-error_ny
                        {% else %}badge-etc_ny{% endif %}">
                        {{ question.get_category_display }}
                    </span>
                </div>

                <a href="{% url 'questions:questions_read' question.id %}">
                    <div class="card-content_ny">
                        {{ question.title }}
                    </div>
                </a>

                <div class="card-footer_ny">
                    <span>{{ question.created_at|date:"Y.m.d" }}</span>
                    <span>ì €ë„ ê¶ê¸ˆí•´ìš” ğŸ˜¢ {{ question.likes.count }}</span>
                </div>
            </div>
            {% empty %}
                <p style="text-align: center; color: #888; margin-top: 50px;">
                    ì•„ì§ ë“±ë¡ëœ ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.
                </p>
            {% endfor %}

            <a href="{% url 'questions:question_main' session.id %}" class="floating-btn_ny" title="ì§ˆë¬¸ ì‘ì„±í•˜ê¸°">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 17.25V21H6.75L17.81 9.94L14.06 6.19L3 17.25ZM20.71 7.04C21.1 6.65 21.1 6.02 20.71 5.63L18.37 3.29C17.98 2.9 17.35 2.9 16.96 3.29L15.13 5.12L18.88 8.87L20.71 7.04Z" fill="black"/>
                </svg>
            </a>
        </section>

        <section class="write-section_ny">
            <div class="form-title_ny">ì§ˆë¬¸ ì‘ì„±í•˜ê¸°</div>
            
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                
                <div class="form-group_ny">
                    <label for="{{ form.category.id_for_label }}">ì§ˆë¬¸ ì¢…ë¥˜</label>
                    {{ form.category }}
                </div>

                <div class="form-group_ny">
                    <label for="{{ form.title.id_for_label }}">ì œëª©</label>
                    {{ form.title }}
                </div>

                <div class="form-group_ny">
                    <label for="{{ form.content.id_for_label }}">ë‚´ìš©</label>
                    {{ form.content }}
                </div>
                
                 <div class="form-group_ny">
                    <label>ì´ë¯¸ì§€ ì²¨ë¶€</label>
                    {{ form.image }}
                </div>

                <!-- <div class="form-group_ny">
                    <label>ë‹µë³€ í¬ë§ ì‹œê°„</label>
                    {{ form.timing }}
                </div> -->

                <button type="submit" class="submit-btn_ny">ì§ˆë¬¸ ë“±ë¡í•˜ê¸°</button>
            </form>
        </section>

    </main>

    <script src="{% static 'questions/js/main_ny.js' %}"></script>
</body>
</html>